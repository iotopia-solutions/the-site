{"version":3,"sources":["routes/index.js"],"names":["router","Router","get","index","post","req","res","returnObj","result","gmailTransport","createTransport","service","auth","user","pass","emailMsg","body","subject","description","email","console","log","sendMail","to","name","html","err","info","send","from","module","exports"],"mappings":"AAAA;;AAEA;;;;AACA;;;;AAGA;;;;AACA;;;;AACA;;;;;;AACA;;AAEA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;AAPA;AACA;;;AAQAD,OAAOE,GAAP,CAAW,GAAX,EAAgB,gBAAMC,KAAtB;AACA;AACA;AACA;AACA;AACA;;AAEAH,OAAOI,IAAP,CAAY,QAAZ,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAClC,MAAIC,YAAY;AACZC,YAAQ;AADI,GAAhB;;AAIA,MAAIC,iBAAiB,qBAAOC,eAAP,CAAuB,uCAAc;AACxDC,aAAS,OAD+C;AAExDC,UAAM;AACJ;AACAC,YAAM,6BAFF;AAGJC,YAAM;AAHF;AAFkD,GAAd,CAAvB,CAArB;;AASA,MAAIC,WAAW,iBAAiBV,IAAIW,IAAJ,CAASC,OAAT,IAAoB,KAArC,IAA8C,yBAA9C,GAA0EZ,IAAIW,IAAJ,CAASE,WAAnF,GAAiG,mBAAjG,GAAuHb,IAAIW,IAAJ,CAASG,KAA/I;;AAEAC,UAAQC,GAAR,CAAYN,QAAZ;;AAEAN,iBAAea,QAAf,CAAwB;AACtBC,QAAI,qDADkB;AAEtBN,aAAS,kBAAkBZ,IAAIW,IAAJ,CAASQ,IAFd;AAGtBC,UAAMV;AAHgB,GAAxB,EAIG,UAACW,GAAD,EAAMC,IAAN,EAAe;AAChB,QAAID,GAAJ,EAAS;AACPN,cAAQC,GAAR,CAAYK,GAAZ;AACAnB,gBAAUC,MAAV,GAAmB,MAAnB;AACAF,UAAIsB,IAAJ,CAASrB,SAAT;AACD;;AAEDE,mBAAea,QAAf,CAAwB;AACtBO,YAAM,qDADgB;AAEtBN,UAAIlB,IAAIW,IAAJ,CAASG,KAFS;AAGtBF,eAAS,4BAHa;AAItBQ,YAAM,UAAUpB,IAAIW,IAAJ,CAASQ,IAAnB,GAA0B,2HAA1B,GAAwJnB,IAAIW,IAAJ,CAASE,WAAjK,GAA+K;AAJ/J,KAAxB,EAKG,UAACQ,GAAD,EAAMC,IAAN,EAAe;AACdP,cAAQC,GAAR,CAAYM,IAAZ;AACF,UAAID,GAAJ,EAAS;AACLnB,kBAAUC,MAAV,GAAmB,MAAnB;AACH;;AAEDF,UAAIsB,IAAJ,CAASrB,SAAT;AACD,KAZD;AAaD,GAxBD;AAyBD,CA3CD;;AA6CAuB,OAAOC,OAAP,GAAiB/B,MAAjB","file":"routes/index.js","sourcesContent":["'use strict';\n\nimport express    from 'express';\nimport pages      from './pages';\n// import portfolio  from './portfolio';\n// import blog       from './blog';\nimport fs         from 'fs';\nimport mailer     from 'nodemailer';\nimport smtpTransport from 'nodemailer-smtp-transport';\n// import oauth  from 'xoauth2';\n\nlet router = express.Router();\n\nrouter.get('/', pages.index);\n// router.get('/portfolio/:name', portfolio.index);\n// router.get('/portfolio/detail/:name', portfolio.detail);\n// router.get('/contact', pages.contact);\n// router.get('/blog', blog.index);\n// router.get('/blog/:id', blog.posts);\n\nrouter.post('/email', (req, res) => {\n  let returnObj = {\n      result: 'sent'\n  };\n\n  let gmailTransport = mailer.createTransport(smtpTransport({\n    service: 'gmail',\n    auth: {\n      // xoauth2: generator\n      user: 'hello@iotopia-solutions.com',\n      pass: 'uSyiKT;d49=:rXb.'\n    }\n  }));\n\n  let emailMsg = 'Regarding: ' + (req.body.subject || 'N/A') + '<br/><br/>Description: ' + req.body.description + '<br/><br/>Email: ' + req.body.email;\n\n  console.log(emailMsg);\n\n  gmailTransport.sendMail({\n    to: 'Iotopia Solutions Inc <hello@iotopia-solutions.com>',\n    subject: 'Inquiry from ' + req.body.name,\n    html: emailMsg\n  }, (err, info) => {\n    if (err) {\n      console.log(err);\n      returnObj.result = 'fail';\n      res.send(returnObj);\n    }\n\n    gmailTransport.sendMail({\n      from: 'Iotopia Solutions Inc <hello@iotopia-solutions.com>',\n      to: req.body.email,\n      subject: 'Thank you for your inquiry',\n      html: 'Dear ' + req.body.name + ',<br/><br/><p>Thank you for your inquiry to Iotopia Solutions Inc. We have receive the following message:</p><blockquote>' + req.body.description + '</blockquote><p>Someone will be in touch in with you shortly.</p> <p>Cheers, <br/><br/>Kianosh Pourian<br/>Principal Partner</p>' \n    }, (err, info) => {\n        console.log(info);\n      if (err) {\n          returnObj.result = 'fail';\n      }\n\n      res.send(returnObj);\n    })\n  });  \n});\n\nmodule.exports = router;"],"sourceRoot":"/Volumes/LaCie/Cloud/Dropbox (Iotopia Soltuions)/Iotopia Soltuions Team Folder/Iotopia Solutions/the-site/es6"}